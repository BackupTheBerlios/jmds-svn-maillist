<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Jmds-svn] r14 - in members/jguers/TestCard/src/de/berlios/jmds: . client client/core server server/core tools
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/jmds-svn/2005-February/index.html" >
   <LINK REL="made" HREF="mailto:jmds-svn%40lists.berlios.de?Subject=Re%3A%20%5BJmds-svn%5D%20r14%20-%20in%20members/jguers/TestCard/src/de/berlios/jmds%3A%20.%20client%20client/core%20server%20server/core%20tools&In-Reply-To=%3C200502182244.j1IMikjt019147%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000017.html">
   <LINK REL="Next"  HREF="000019.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Jmds-svn] r14 - in members/jguers/TestCard/src/de/berlios/jmds: . client client/core server server/core tools</H1>
    <B>S&#233;bastien Guinchard at BerliOS</B> 
    <A HREF="mailto:jmds-svn%40lists.berlios.de?Subject=Re%3A%20%5BJmds-svn%5D%20r14%20-%20in%20members/jguers/TestCard/src/de/berlios/jmds%3A%20.%20client%20client/core%20server%20server/core%20tools&In-Reply-To=%3C200502182244.j1IMikjt019147%40sheep.berlios.de%3E"
       TITLE="[Jmds-svn] r14 - in members/jguers/TestCard/src/de/berlios/jmds: . client client/core server server/core tools">sguincha at sheep.berlios.de
       </A><BR>
    <I>Fri Feb 18 23:44:46 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000017.html">[Jmds-svn] r13 - members/jguers/TestCard/src/de/berlios/jmds/applet
</A></li>
        <LI>Next message: <A HREF="000019.html">[Jmds-svn] r15 - in trunk: . generated-src/fr/umlv/ir3/corba/sguincha/td2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18">[ date ]</a>
              <a href="thread.html#18">[ thread ]</a>
              <a href="subject.html#18">[ subject ]</a>
              <a href="author.html#18">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: sguincha
Date: 2005-02-18 23:44:45 +0100 (Fri, 18 Feb 2005)
New Revision: 14

Removed:
   members/jguers/TestCard/src/de/berlios/jmds/test/
Modified:
   members/jguers/TestCard/src/de/berlios/jmds/client/ForumClient.java
   members/jguers/TestCard/src/de/berlios/jmds/client/core/ClientInter.java
   members/jguers/TestCard/src/de/berlios/jmds/server/ForumServer.java
   members/jguers/TestCard/src/de/berlios/jmds/server/core/ForumImpl.java
   members/jguers/TestCard/src/de/berlios/jmds/server/core/ServerInter.java
   members/jguers/TestCard/src/de/berlios/jmds/tools/Convertor.java
Log:


Modified: members/jguers/TestCard/src/de/berlios/jmds/client/ForumClient.java
===================================================================
--- members/jguers/TestCard/src/de/berlios/jmds/client/ForumClient.java	2005-02-18 22:44:27 UTC (rev 13)
+++ members/jguers/TestCard/src/de/berlios/jmds/client/ForumClient.java	2005-02-18 22:44:45 UTC (rev 14)
@@ -20,12 +20,16 @@
 public class ForumClient
 {
 
+	/**
+	 * @param args
+	 * @throws IOException
+	 */
 	public static void main (String [] args) throws IOException
 	{
 
 		/* initialisation de l'ORB */
 		Properties prop = new Properties ();
-		prop.put (&quot;org.omg.PortableInterceptor.ORBInitializerClass.de.berlios.jmds.core.MonClientORBInitializer&quot; , &quot;&quot;);
+		prop.put (&quot;org.omg.PortableInterceptor.ORBInitializerClass.de.berlios.jmds.client.core.ClientORBInitializer&quot; , &quot;&quot;);
 		ORB orb = ORB.init (args , prop);
 		/* R&#233;cup&#233;ration de l'id de l'objet servant */
 		BufferedReader buffer = new BufferedReader (new FileReader (&quot;ObjectRef&quot;));
@@ -49,13 +53,14 @@
 			{
 				case 'a' :
 				{
-					System.out.print (&quot;Votre nom: &quot;);
+					/*System.out.print (&quot;Votre nom: &quot;);
 					String auth = in.readLine ();
 					System.out.print (&quot;Titre du message: &quot;);
 					String title = in.readLine ();
 					System.out.print (&quot;Message: &quot;);
 					String mess = in.readLine ();
-					forumProxy.postMessage (new Message (title, auth, (new Date ()).toString (), mess));
+					forumProxy.postMessage (new Message (title, auth, (new Date ()).toString (), mess));*/
+					forumProxy.postMessage (new Message (&quot;toto&quot;, &quot;titi&quot;, (new Date ()).toString (), &quot;tutu&quot;));
 				}
 					break;
 

Modified: members/jguers/TestCard/src/de/berlios/jmds/client/core/ClientInter.java
===================================================================
--- members/jguers/TestCard/src/de/berlios/jmds/client/core/ClientInter.java	2005-02-18 22:44:27 UTC (rev 13)
+++ members/jguers/TestCard/src/de/berlios/jmds/client/core/ClientInter.java	2005-02-18 22:44:45 UTC (rev 14)
@@ -9,9 +9,7 @@
 import org.omg.PortableInterceptor.ClientRequestInterceptor;
 import org.omg.PortableInterceptor.ForwardRequest;
 
-import com.sun.corba.se.spi.ior.iiop.GIOPVersion;
 
-
 /**
  * @author sguincha go to Window - Preferences - Java - Code Style - Code
  *         Templates
@@ -29,11 +27,10 @@
 	 */
 	public void send_request (ClientRequestInfo ri) throws ForwardRequest
 	{
-		GIOPVersion version;
 		ServiceContext sc = new ServiceContext ();
-		sc.context_data = new byte [65];
-
-		ri.add_request_service_context (sc , true);
+		byte[] scData = &quot;toto&quot;.getBytes();
+		sc.context_data = scData;
+		ri.add_request_service_context (sc, true);
 		System.out.println (&quot;ClientInter.send request: &quot; + ri.operation ());
 	}
 
@@ -50,7 +47,10 @@
 	 */
 	public void receive_reply (ClientRequestInfo ri)
 	{
-		System.out.println (&quot;ClientInter.receive reply: &quot; + ri.operation ());
+		ServiceContext sc = ri.get_reply_service_context(0);
+		String sData = new String(sc.context_data);
+		System.out.println (&quot;ClientInter.receive reply: &quot; + sData);
+		
 	}
 
 	/**

Modified: members/jguers/TestCard/src/de/berlios/jmds/server/ForumServer.java
===================================================================
--- members/jguers/TestCard/src/de/berlios/jmds/server/ForumServer.java	2005-02-18 22:44:27 UTC (rev 13)
+++ members/jguers/TestCard/src/de/berlios/jmds/server/ForumServer.java	2005-02-18 22:44:45 UTC (rev 14)
@@ -23,11 +23,20 @@
 public class ForumServer
 {
 
+	/**
+	 * @param args
+	 * @throws InvalidName
+	 * @throws ServantAlreadyActive
+	 * @throws ObjectNotActive
+	 * @throws WrongPolicy
+	 * @throws IOException
+	 * @throws AdapterInactive
+	 */
 	public static void main (String [] args) throws InvalidName, ServantAlreadyActive, ObjectNotActive, WrongPolicy, IOException, AdapterInactive
 	{
 		/* Initialisation de l'ORB */
 		Properties prop = new Properties ();
-		prop.put (&quot;org.omg.PortableInterceptor.ORBInitializerClass.de.berlios.jmds.core.MonServerORBInitializer&quot; , &quot;&quot;);
+		prop.put (&quot;org.omg.PortableInterceptor.ORBInitializerClass.de.berlios.jmds.server.core.ServerORBInitializer&quot; , &quot;&quot;);
 		ORB orb = ORB.init (args , prop);
 
 		/* R&#233;cup&#233;ration de r&#233;f&#233;rence de l'adaptateur d'objet racine */

Modified: members/jguers/TestCard/src/de/berlios/jmds/server/core/ForumImpl.java
===================================================================
--- members/jguers/TestCard/src/de/berlios/jmds/server/core/ForumImpl.java	2005-02-18 22:44:27 UTC (rev 13)
+++ members/jguers/TestCard/src/de/berlios/jmds/server/core/ForumImpl.java	2005-02-18 22:44:45 UTC (rev 14)
@@ -19,6 +19,10 @@
 	private String				theme;
 	private ConcurrentHashMap	discussion;
 
+	/**
+	 * @param theme
+	 * @param moderator
+	 */
 	public ForumImpl (String theme, String moderator)
 	{
 		this.theme = theme;
@@ -26,16 +30,26 @@
 		discussion = new ConcurrentHashMap ();
 	}
 
+	/**
+	 * @see fr.umlv.ir3.corba.sguincha.td2.ForumOperations#theme()
+	 */
 	public String theme ()
 	{
 		return theme;
 	}
 
+	
+	/**
+	 * @see fr.umlv.ir3.corba.sguincha.td2.ForumOperations#moderator()
+	 */
 	public String moderator ()
 	{
 		return moderator;
 	}
 
+	/**
+	 * @see fr.umlv.ir3.corba.sguincha.td2.ForumOperations#postMessage(fr.umlv.ir3.corba.sguincha.td2.Message)
+	 */
 	public boolean postMessage (Message m)
 	{
 		if (discussion.putIfAbsent (theme , m) == null)
@@ -43,16 +57,25 @@
 		return false;
 	}
 
+	/**
+	 * @see fr.umlv.ir3.corba.sguincha.td2.ForumOperations#getMessage(java.lang.String)
+	 */
 	public Message getMessage (String title)
 	{
 		return (Message) discussion.get (title);
 	}
 
+	/**
+	 * @see fr.umlv.ir3.corba.sguincha.td2.ForumOperations#getMessages()
+	 */
 	public Message [] getMessages ()
 	{
 		return (Message []) discussion.values ().toArray (new Message [discussion.size ()]);
 	}
 
+	/**
+	 * @see fr.umlv.ir3.corba.sguincha.td2.ForumOperations#removeMessage(java.lang.String)
+	 */
 	public boolean removeMessage (String title)
 	{
 		if (discussion.containsKey (title))

Modified: members/jguers/TestCard/src/de/berlios/jmds/server/core/ServerInter.java
===================================================================
--- members/jguers/TestCard/src/de/berlios/jmds/server/core/ServerInter.java	2005-02-18 22:44:27 UTC (rev 13)
+++ members/jguers/TestCard/src/de/berlios/jmds/server/core/ServerInter.java	2005-02-18 22:44:45 UTC (rev 14)
@@ -4,6 +4,7 @@
  */
 package de.berlios.jmds.server.core;
 
+import org.omg.IOP.ServiceContext;
 import org.omg.PortableInterceptor.ForwardRequest;
 import org.omg.PortableInterceptor.ServerRequestInfo;
 import org.omg.PortableInterceptor.ServerRequestInterceptor;
@@ -26,7 +27,11 @@
 	 */
 	public void receive_request_service_contexts (ServerRequestInfo ri) throws ForwardRequest
 	{
-		System.out.println (&quot;ServerInter.receive request_SC: &quot; + ri.operation ());
+		ServiceContext sc = ri.get_request_service_context (0);
+		String sData = new String (sc.context_data);
+		System.out.println (&quot;ServerInter.receive request_SC: &quot; + sData);
+		sc.context_data = &quot;titi&quot;.getBytes ();
+		ri.add_reply_service_context (sc , true);
 
 	}
 
@@ -43,6 +48,9 @@
 	 */
 	public void send_reply (ServerRequestInfo ri)
 	{
+		ServiceContext sc = ri.get_request_service_context (0);
+		sc.context_data = &quot;titi&quot;.getBytes ();
+		ri.add_reply_service_context (sc , true);
 		System.out.println (&quot;ServerInter.send_reply: &quot; + ri.operation ());
 
 	}

Modified: members/jguers/TestCard/src/de/berlios/jmds/tools/Convertor.java
===================================================================
--- members/jguers/TestCard/src/de/berlios/jmds/tools/Convertor.java	2005-02-18 22:44:27 UTC (rev 13)
+++ members/jguers/TestCard/src/de/berlios/jmds/tools/Convertor.java	2005-02-18 22:44:45 UTC (rev 14)
@@ -16,6 +16,8 @@
     
     /**
      * DOCME
+     * @param value 
+     * @return a table of short
      */
     public final static short[] stringToShortArray(String value) {
         short shortKey[] = new short[(value.length() / 2)];
@@ -40,6 +42,8 @@
     
     /**
      * DOCME
+     * @param value 
+     * @return a table of int containing the stirng
      */
     public static int[] stringToIntArray(String value) {
         int intKey[] = new int[(value.length() / 2)];
@@ -62,5 +66,18 @@
         }
         return intKey;
     }
+
+	/**
+	 * @param context_data
+	 * @return string of the byte table
+	 */
+	public static String byteToString (byte [] context_data)
+	{
+		StringBuffer sb = new StringBuffer();
+		for(int i=0; i &lt; context_data.length; i++) {
+			sb.append(context_data[i]);
+		}
+		return sb.toString();
+	}
 }
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000017.html">[Jmds-svn] r13 - members/jguers/TestCard/src/de/berlios/jmds/applet
</A></li>
	<LI>Next message: <A HREF="000019.html">[Jmds-svn] r15 - in trunk: . generated-src/fr/umlv/ir3/corba/sguincha/td2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#18">[ date ]</a>
              <a href="thread.html#18">[ thread ]</a>
              <a href="subject.html#18">[ subject ]</a>
              <a href="author.html#18">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/jmds-svn">More information about the Jmds-svn
mailing list</a><br>
</body></html>
